---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import { DOMAINS_CONFIG, COLOR_CLASSES, TEXT_COLORS, ICON_COLORS } from '../config/domains';

// Récupération des articles et livres
const articles = await getCollection('articles');
const books = await getCollection('books');

// Tri des articles par date de publication (du plus récent au plus ancien)
const sortedArticles = articles.sort((a, b) => {
	const dateA = new Date(a.data.publishDate || '2024-01-01');
	const dateB = new Date(b.data.publishDate || '2024-01-01');
	return dateB.getTime() - dateA.getTime();
});

// Tri des livres par année de publication
const sortedBooks = books.sort((a, b) => (b.data.publishYear || 0) - (a.data.publishYear || 0));

// Définition des domaines de compétence avec hashtags (cohérents avec la page d'accueil)
const domainesCompetences = {
	"Formation & Pédagogie": {
		description: "Articles sur la formation, le développement des compétences et l'apprentissage continu",
		color: "red",
		icon: "fas fa-graduation-cap",
		keywords: ["#formation", "#apprentissage", "#compétences", "#mentorat", "#elearning", "#développement", "#softskills", "#continue", "#pédagogie", "#coaching"],
		articles: sortedArticles
			.filter(article => {
				const title = article.data.title?.toLowerCase() || '';
				const tags = article.data.tags || [];
				const tagStr = tags.join(' ').toLowerCase();
				const content = title + ' ' + tagStr;
				
				return content.includes('formation') || 
					   content.includes('apprentissage') || 
					   content.includes('compétences') ||
					   content.includes('mentorat') ||
					   content.includes('e-learning') ||
					   content.includes('elearning') ||
					   content.includes('développement personnel') ||
					   content.includes('soft skills') ||
					   content.includes('softskills') ||
					   content.includes('continue') ||
					   content.includes('pédagogie') ||
					   content.includes('coaching') ||
					   content.includes('impact formation') ||
					   content.includes('reconversion') ||
					   content.includes('formation-adaptation') ||
					   content.includes('formation-collaboration') ||
					   content.includes('formation-communication') ||
					   content.includes('formation-continue') ||
					   content.includes('formation-creativite') ||
					   content.includes('formation-elearning') ||
					   content.includes('formation-innovation') ||
					   content.includes('formation-leadership') ||
					   content.includes('formation-mentorat') ||
					   content.includes('formation-professionnelle-continue') ||
					   content.includes('formation-soft-skills') ||
					   content.includes('formation-talents-guide') ||
					   content.includes('formation-technique') ||
					   content.includes('gestion-competences-developpement') ||
					   content.includes('gestion-talents-attraction') ||
					   content.includes('gestion-talents-developpement') ||
					   content.includes('gestion-talents-fidelisation') ||
					   content.includes('gestion-talents-formation') ||
					   content.includes('gestion-talents-performance') ||
					   content.includes('gestion-talents-recrutement') ||
					   content.includes('gestion-talents-remuneration') ||
					   content.includes('gestion-talents-retention') ||
					   content.includes('gestion-talents-succession') ||
					   content.includes('gestion-talents-valuation') ||
					   content.includes('recrutement-talents-digitaux') ||
					   content.includes('mentoring-developpement-professionnel') ||
					   content.includes('reconversion-professionnelle-reussie') ||
					   content.includes('impact-formation-continue-carriere') ||
					   content.includes('importance-leadership');
			})
			.slice(0, 6)
	},
	"Gestion de Projet Télécom": {
		description: "Pilotage de projets complexes, gestion d'équipes et méthodologies agiles",
		color: "blue", 
		icon: "fas fa-tasks",
		keywords: ["#gestionprojet", "#agile", "#scrum", "#management", "#équipe", "#performance", "#risques", "#temps", "#priorités", "#productivité", "#leadership"],
		articles: sortedArticles
			.filter(article => {
				const title = article.data.title?.toLowerCase() || '';
				const tags = article.data.tags || [];
				const tagStr = tags.join(' ').toLowerCase();
				const content = title + ' ' + tagStr;
				
				return content.includes('gestion projet') || 
					   content.includes('gestionprojet') ||
					   content.includes('agile') || 
					   content.includes('scrum') ||
					   content.includes('management') ||
					   content.includes('équipe') ||
					   content.includes('performance') ||
					   content.includes('risques') ||
					   content.includes('temps') ||
					   content.includes('priorités') ||
					   content.includes('productivité') ||
					   content.includes('leadership') ||
					   content.includes('conflits') ||
					   content.includes('stress') ||
					   content.includes('surcharge') ||
					   content.includes('gtd') ||
					   content.includes('pomodoro') ||
					   content.includes('deep work') ||
					   content.includes('leadership-equipes-performance') ||
					   content.includes('gestion-conflits-equipe') ||
					   content.includes('gestion-performance-equipe') ||
					   content.includes('gestion-stress-performance') ||
					   content.includes('gestion-temps-productivite') ||
					   content.includes('gestion-temps-professionnels') ||
					   content.includes('gestion-temps') ||
					   content.includes('methode-gtd') ||
					   content.includes('methode-pomodoro') ||
					   content.includes('deep-work') ||
					   content.includes('gestion-priorites-efficacite') ||
					   content.includes('gestion-surcharge-informationnelle') ||
					   content.includes('productivite-professionnelle') ||
					   content.includes('procrastination-solutions') ||
					   content.includes('agile-scrum-methodologies');
			})
			.slice(0, 6)
	},
	"Développement Web": {
		description: "Tendances, technologies et bonnes pratiques du développement web moderne",
		color: "green",
		icon: "fas fa-laptop-code",
		keywords: ["#react", "#javascript", "#web", "#frontend", "#backend", "#technologies", "#performance", "#optimisation", "#accessibilité", "#pwa", "#frameworks", "#tendances"],
		articles: sortedArticles
			.filter(article => {
				const title = article.data.title?.toLowerCase() || '';
				const tags = article.data.tags || [];
				const tagStr = tags.join(' ').toLowerCase();
				const content = title + ' ' + tagStr;
				
				return content.includes('react') || 
					   content.includes('javascript') || 
					   content.includes('développement web') ||
					   content.includes('web') ||
					   content.includes('frontend') ||
					   content.includes('backend') ||
					   content.includes('technologies') ||
					   content.includes('performance') ||
					   content.includes('optimisation') ||
					   content.includes('accessibilité') ||
					   content.includes('pwa') ||
					   content.includes('frameworks') ||
					   content.includes('tendances') ||
					   content.includes('progressive') ||
					   content.includes('modern') ||
					   content.includes('ia') ||
					   content.includes('intelligence artificielle');
			})
			.slice(0, 6)
	},
	"Qualité & Process": {
		description: "Certification ISO, processus qualité et amélioration continue",
		color: "purple",
		icon: "fas fa-check-circle",
		keywords: ["#qualité", "#processus", "#certification", "#iso", "#amélioration", "#audit", "#conformité", "#optimisation", "#stratégie", "#entreprise", "#transformation"],
		articles: sortedArticles
			.filter(article => {
				const title = article.data.title?.toLowerCase() || '';
				const tags = article.data.tags || [];
				const tagStr = tags.join(' ').toLowerCase();
				const content = title + ' ' + tagStr;
				
				return content.includes('qualité') || 
					   content.includes('processus') || 
					   content.includes('certification') ||
					   content.includes('iso') ||
					   content.includes('amélioration') ||
					   content.includes('audit') ||
					   content.includes('conformité') ||
					   content.includes('optimisation') ||
					   content.includes('stratégie') ||
					   content.includes('entreprise') ||
					   content.includes('transformation') ||
					   content.includes('transformation digitale') ||
					   content.includes('transformation numérique') ||
					   content.includes('gestion connaissances') ||
					   content.includes('diversité') ||
					   content.includes('inclusion') ||
					   content.includes('transformation-digitale-telecom') ||
					   content.includes('transformation-numerique-entreprise') ||
					   content.includes('transformation-numerique-talents') ||
					   content.includes('gestion-qualite-processus') ||
					   content.includes('gestion-qualite-amelioration') ||
					   content.includes('gestion-qualite-certification') ||
					   content.includes('gestion-qualite-entreprise') ||
					   content.includes('gestion-qualite-strategie') ||
					   content.includes('optimisation-processus-entreprise') ||
					   content.includes('qualite-processus-entreprise') ||
					   content.includes('management-diversite-inclusion') ||
					   content.includes('management-hybride') ||
					   content.includes('gestion-connaissances-organisation');
			})
			.slice(0, 6)
	},
	"Développement Commercial": {
		description: "Stratégies commerciales, marketing digital et techniques de vente",
		color: "orange",
		icon: "fas fa-handshake",
		keywords: ["#commercial", "#marketing", "#vente", "#client", "#service", "#business", "#partenariat", "#négociation", "#salaire", "#réseauxsociaux", "#digital", "#stratégies"],
		articles: sortedArticles
			.filter(article => {
				const title = article.data.title?.toLowerCase() || '';
				const tags = article.data.tags || [];
				const tagStr = tags.join(' ').toLowerCase();
				const content = title + ' ' + tagStr;
				
				return content.includes('commercial') || 
					   content.includes('marketing') || 
					   content.includes('vente') ||
					   content.includes('client') ||
					   content.includes('service') ||
					   content.includes('business') ||
					   content.includes('partenariat') ||
					   content.includes('négociation') ||
					   content.includes('salaire') ||
					   content.includes('réseaux sociaux') ||
					   content.includes('réseauxsociaux') ||
					   content.includes('digital') ||
					   content.includes('stratégies') ||
					   content.includes('content') ||
					   content.includes('email') ||
					   content.includes('personnalisation') ||
					   content.includes('excellence') ||
					   content.includes('attraction') ||
					   content.includes('fidélisation') ||
					   content.includes('formation équipes commerciales') ||
					   content.includes('formation-equipes-commerciales') ||
					   content.includes('strategies-marketing-digital') ||
					   content.includes('email-marketing') ||
					   content.includes('service-client') ||
					   content.includes('negocier-salaire');
			})
			.slice(0, 6)
	}
};

// Couleurs pour les badges (cohérentes avec la page d'accueil)
const colorClasses = {
	...COLOR_CLASSES,
	teal: "bg-teal-100 text-teal-800 dark:bg-teal-900/30 dark:text-teal-300",
	indigo: "bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300"
};

// Fonction pour formater la date
function formatDate(date: Date | string): string {
	const dateObj = typeof date === 'string' ? new Date(date) : date;
	return dateObj.toLocaleDateString('fr-FR', {
		year: 'numeric',
		month: 'long',
		day: 'numeric'
	});
}

// Statistiques
const totalArticles = articles.length;
const totalBooks = books.length;
const totalDomaines = Object.keys(domainesCompetences).length;
---

<BaseLayout 
	title="Blog & Articles | Gérald Paméole | Expert Transformation Digitale" 
	description="Articles et recommandations de livres organisés par spécialités. Expertise en gestion de projet, développement web et formation professionnelle."
	customClass="bg-gradient-to-br from-gray-50 to-white dark:from-gray-900 dark:to-gray-800"
>
	<main class="content-container-wide py-12">
		<!-- En-tête de page avec animations -->
		<section class="py-16 md:py-24 bg-gradient-to-r from-indigo-600/10 to-violet-600/10 w-screen relative overflow-hidden" style="margin-left: calc(50% - 50vw); margin-right: calc(50% - 50vw)">
			<!-- Particules flottantes en arrière-plan -->
			<div class="absolute inset-0 overflow-hidden pointer-events-none">
				<div class="floating-particle" style="top: 20%; left: 10%; animation-delay: 0s;"></div>
				<div class="floating-particle" style="top: 60%; left: 80%; animation-delay: 2s;"></div>
				<div class="floating-particle" style="top: 40%; left: 30%; animation-delay: 4s;"></div>
				<div class="floating-particle" style="top: 80%; left: 60%; animation-delay: 6s;"></div>
				<div class="floating-particle" style="top: 30%; left: 90%; animation-delay: 8s;"></div>
			</div>
			
			<div class="content-container text-center relative z-10">
				<!-- Titre avec animation de frappe -->
				<h1 class="text-4xl md:text-5xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-blue-500 animate-fade-in-up">
					<span class="typing-animation">Blog & Articles</span>
				</h1>
				<p class="text-xl text-[#111827] dark:text-gray-200 mb-6 animate-fade-in-up" style="animation-delay: 0.5s;">
					Partage de connaissances, expériences et recommandations pour votre développement professionnel
				</p>
				
				<!-- Badges avec animation de rebond -->
				<div class="flex flex-wrap justify-center gap-3 mb-8 animate-fade-in-up" style="animation-delay: 1s;">
					<span class={`px-4 py-2 rounded-full ${COLOR_CLASSES.blue} hover:scale-110 transition-transform duration-300 cursor-pointer`} data-domain="gestion-projet">Gestion de Projet</span>
					<span class={`px-4 py-2 rounded-full ${COLOR_CLASSES.green} hover:scale-110 transition-transform duration-300 cursor-pointer`} data-domain="developpement-web">Développement Web</span>
					<span class={`px-4 py-2 rounded-full ${COLOR_CLASSES.purple} hover:scale-110 transition-transform duration-300 cursor-pointer`} data-domain="qualite-process">Qualité & Process</span>
					<span class={`px-4 py-2 rounded-full ${COLOR_CLASSES.red} hover:scale-110 transition-transform duration-300 cursor-pointer`} data-domain="formation">Formation</span>
					<span class={`px-4 py-2 rounded-full ${COLOR_CLASSES.orange} hover:scale-110 transition-transform duration-300 cursor-pointer`} data-domain="developpement-commercial">Développement Commercial</span>
				</div>
				
				<!-- Statistiques animées -->
				<div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto mb-8 animate-fade-in-up" style="animation-delay: 1.5s;">
					<div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 group">
						<div class="flex items-center justify-center mb-3">
							<div class="p-3 rounded-full bg-indigo-100 dark:bg-indigo-900/30 group-hover:scale-110 transition-transform duration-300">
								<i class="fas fa-newspaper text-indigo-600 text-xl"></i>
							</div>
						</div>
						<div class="text-3xl font-bold text-indigo-600 mb-2 counter" data-target="{totalArticles}">0</div>
						<div class="text-gray-600 dark:text-gray-400">Articles publiés</div>
					</div>
					<div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 group">
						<div class="flex items-center justify-center mb-3">
							<div class="p-3 rounded-full bg-violet-100 dark:bg-violet-900/30 group-hover:scale-110 transition-transform duration-300">
								<i class="fas fa-book text-violet-600 text-xl"></i>
							</div>
						</div>
						<div class="text-3xl font-bold text-violet-600 mb-2 counter" data-target="{totalBooks}">0</div>
						<div class="text-gray-600 dark:text-gray-400">Livres recommandés</div>
					</div>
					<div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 group">
						<div class="flex items-center justify-center mb-3">
							<div class="p-3 rounded-full bg-blue-100 dark:bg-blue-900/30 group-hover:scale-110 transition-transform duration-300">
								<i class="fas fa-cogs text-blue-600 text-xl"></i>
							</div>
						</div>
						<div class="text-3xl font-bold text-blue-600 mb-2 counter" data-target="{totalDomaines}">0</div>
						<div class="text-gray-600 dark:text-gray-400">Domaines d'expertise</div>
					</div>
				</div>
			</div>
		</section>
		
		<!-- Filtres dynamiques -->
		<div class="content-container mb-12">
			<div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
				<div class="text-center mb-6">
					<h2 class="text-2xl font-bold text-[#111827] dark:text-white mb-2">Filtrer par domaine</h2>
					<p class="text-gray-600 dark:text-gray-400">Cliquez sur un domaine pour voir uniquement ses articles</p>
				</div>
				<div class="flex flex-wrap justify-center gap-3">
					<button class="filter-btn active px-6 py-3 rounded-full bg-indigo-600 text-white font-medium transition-all duration-300 hover:scale-105" data-filter="all">
						<i class="fas fa-th-large mr-2"></i>Tous les domaines
					</button>
					{Object.entries(domainesCompetences).map(([domainName, config]) => {
						const colorClass = colorClasses[config.color as keyof typeof colorClasses];
						return (
							<button class={`filter-btn px-6 py-3 rounded-full ${colorClass} font-medium transition-all duration-300 hover:scale-105`} data-filter={domainName.toLowerCase().replace(/\s+/g, '-')}>
								<i class={`${config.icon} mr-2`}></i>{domainName}
							</button>
						);
					})}
				</div>
			</div>
		</div>

		<!-- Sections par domaines d'expertise -->
		<div class="content-container">
			{Object.entries(domainesCompetences).map(([domainName, config]) => {
				const colorClass = colorClasses[config.color as keyof typeof colorClasses];
				const domainId = domainName.toLowerCase().replace(/\s+/g, '-');
				
				return (
					<section class="domain-section bg-white dark:bg-gray-800 rounded-xl shadow-lg mb-16 p-8 animate-fade-in-up" data-domain={domainId}>
						<!-- En-tête centré -->
						<div class="text-center mb-8">
							<div class="flex items-center justify-center gap-4 mb-4">
								<div class={`p-4 rounded-xl ${colorClass}`}>
									<i class={`${config.icon} text-2xl`}></i>
								</div>
							</div>
							<h2 class="text-3xl font-bold text-[#111827] dark:text-white mb-4">{domainName}</h2>
							<p class="text-lg text-[#111827] dark:text-gray-300 mb-6 max-w-3xl mx-auto">{config.description}</p>
							
							<!-- Affichage des hashtags centrés -->
							<div class="flex flex-wrap justify-center gap-2">
								{config.keywords.map((keyword: string) => (
									<span class="px-3 py-1 text-sm font-medium bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors cursor-pointer">
										{keyword}
							</span>
								))}
							</div>
						</div>
						
						{config.articles.length > 0 ? (
							<>
								<!-- Articles principaux (3 premiers) - Design moderne -->
								<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
									{config.articles.slice(0, 3).map((article, index) => (
										<article class="modern-article-card group" style={`animation-delay: ${index * 0.2}s`}>
											<!-- Image de couverture avec overlay -->
											<div class="relative overflow-hidden rounded-t-2xl h-48 bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500">
												{article.data.image ? (
													<img src={article.data.image} alt={article.data.title} class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" />
												) : (
													<div class="w-full h-full flex items-center justify-center">
														<i class={`${config.icon} text-6xl text-white/80`}></i>
													</div>
												)}
												
												<!-- Overlay avec gradient -->
												<div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"></div>
												
												<!-- Badges flottants -->
												<div class="absolute top-4 left-4 flex flex-col gap-2">
													{article.data.featured && (
														<span class="px-3 py-1 text-xs font-bold bg-yellow-400 text-yellow-900 rounded-full shadow-lg animate-pulse">
															⭐ À la une
														</span>
													)}
													<span class="px-3 py-1 text-xs font-medium bg-white/90 text-gray-800 rounded-full shadow-md">
														{article.data.readingTime || 5} min
													</span>
												</div>
												
												<!-- Bouton favori -->
												<button class="absolute top-4 right-4 p-2 rounded-full bg-white/20 backdrop-blur-sm text-white hover:bg-white/30 transition-all duration-300 opacity-0 group-hover:opacity-100" title="Ajouter aux favoris">
													<i class="fas fa-heart text-sm"></i>
												</button>
												
												<!-- Titre sur l'image -->
												<div class="absolute bottom-4 left-4 right-4">
													<h3 class="text-xl font-bold text-white mb-2 line-clamp-2 drop-shadow-lg">
														{article.data.title}
													</h3>
												</div>
											</div>
											
											<!-- Contenu de la carte -->
											<div class="bg-white dark:bg-gray-800 p-6 rounded-b-2xl shadow-lg group-hover:shadow-2xl transition-all duration-500">
												<!-- Mots-clés hashtags -->
												{(article.data as any).keywords && (article.data as any).keywords.length > 0 && (
													<div class="mb-4">
														<div class="flex flex-wrap gap-2">
															{(article.data as any).keywords.slice(0, 4).map((keyword: string, idx: number) => (
																<span class="hashtag-keyword px-3 py-1 text-xs font-medium bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-700 dark:from-blue-900/30 dark:to-indigo-900/30 dark:text-blue-300 rounded-full hover:from-blue-200 hover:to-indigo-200 dark:hover:from-blue-800/50 dark:hover:to-indigo-800/50 transition-all duration-300 cursor-pointer hover:scale-105 hover:shadow-md" 
																  data-keyword={keyword}>
																	{keyword}
																</span>
															))}
															{(article.data as any).keywords.length > 4 && (
																<span class="px-3 py-1 text-xs font-medium bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 rounded-full">
																	+{(article.data as any).keywords.length - 4}
																</span>
															)}
														</div>
													</div>
												)}
												
												<!-- Description -->
												<p class="text-gray-600 dark:text-gray-300 mb-6 line-clamp-3 leading-relaxed">
													{article.data.description}
												</p>
												
												<!-- Métadonnées et CTA -->
												<div class="flex items-center justify-between pt-4 border-t border-gray-100 dark:border-gray-700">
													<div class="flex items-center gap-3 text-sm text-gray-500 dark:text-gray-400">
														<span class="flex items-center gap-1">
															<i class="fas fa-calendar-alt"></i>
															{formatDate(article.data.publishDate)}
														</span>
														<span class="flex items-center gap-1">
															<i class="fas fa-user"></i>
															{article.data.author || 'Gérald Paméole'}
														</span>
													</div>
													
													<a href={`/articles/${article.slug}`} 
													   class="inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 font-medium text-sm transition-all duration-300 hover:scale-105 hover:shadow-lg group-hover:gap-3">
														Lire l'article
														<i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
													</a>
												</div>
					</div>
										</article>
				))}
			</div>
								
								<!-- Articles supplémentaires (3 suivants) si disponibles -->
								{config.articles.length > 3 && (
									<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
										{config.articles.slice(3, 6).map((article: any) => (
											<article class="bg-gray-50 dark:bg-gray-700 rounded-lg p-6 hover:shadow-md transition-shadow duration-300 border border-gray-200 dark:border-gray-600">
												<div class="flex items-center gap-2 mb-3">
													{article.data.featured && (
														<span class="px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 rounded-full">
															⭐ À la une
														</span>
													)}
													<span class="px-2 py-1 text-xs font-medium bg-gray-100 text-[#111827] dark:bg-gray-600 dark:text-gray-200 rounded-full">
														{article.data.readingTime || 5} min
													</span>
												</div>
												
												<!-- Mots-clés hashtags pour articles supplémentaires -->
												{(article.data as any).keywords && (article.data as any).keywords.length > 0 && (
													<div class="mb-3">
														<div class="flex flex-wrap gap-1">
															{(article.data as any).keywords.slice(0, 3).map((keyword: string, index: number) => (
																<span class="hashtag-keyword px-2 py-1 text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800/50 transition-all duration-300 cursor-pointer hover:scale-105" 
																  data-keyword={keyword}>
																	{keyword}
																</span>
															))}
															{(article.data as any).keywords.length > 3 && (
																<span class="px-2 py-1 text-xs font-medium bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 rounded-full">
																	+{(article.data as any).keywords.length - 3}
																</span>
															)}
														</div>
													</div>
												)}
												
												<h3 class="text-lg font-bold text-[#111827] dark:text-white mb-2 line-clamp-2">
													<a href={`/articles/${article.slug}`} class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
														{article.data.title}
													</a>
												</h3>
												
												<p class="text-[#111827] dark:text-gray-300 mb-4 line-clamp-2">
													{article.data.description}
												</p>
												
												<div class="flex items-center justify-between">
													<span class="text-sm text-gray-500 dark:text-gray-400">
														{formatDate(article.data.publishDate)}
													</span>
													<a href={`/articles/${article.slug}`} 
													   class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium text-sm transition-colors">
														Lire →
													</a>
												</div>
											</article>
										))}
									</div>
								)}
							</>
						) : (
							<div class="text-center py-12 text-gray-500 dark:text-gray-400">
								<div class="mb-4">
									<i class="fas fa-newspaper text-4xl text-gray-300 dark:text-gray-600"></i>
								</div>
								<p class="text-lg">Aucun article disponible pour ce domaine pour le moment.</p>
								<p class="text-sm mt-2">De nouveaux contenus seront bientôt publiés !</p>
							</div>
						)}
						
						<div class="text-center mt-8">
							<a href="/articles" class={`inline-flex items-center gap-2 px-6 py-3 ${config.color === 'blue' ? 'bg-blue-600 hover:bg-blue-700' : config.color === 'green' ? 'bg-green-600 hover:bg-green-700' : config.color === 'purple' ? 'bg-purple-600 hover:bg-purple-700' : config.color === 'red' ? 'bg-red-600 hover:bg-red-700' : 'bg-orange-600 hover:bg-orange-700'} text-white rounded-lg transition-colors font-medium`}>
								Voir tous les articles {domainName}
								<i class="fas fa-arrow-right"></i>
							</a>
			</div>
		</section>
				);
			})}
		</div>

		<!-- Section des livres recommandés -->
		<section class="bg-white dark:bg-gray-800 rounded-xl shadow-lg mb-16">
			<div class="content-container p-8">
				<!-- En-tête centré -->
				<div class="text-center mb-12">
					<div class="flex items-center justify-center gap-4 mb-6">
						<div class="p-4 rounded-xl bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300">
							<i class="fas fa-book text-2xl"></i>
						</div>
					</div>
					<h2 class="text-3xl font-bold text-[#111827] dark:text-white mb-4">
						Livres recommandés
					</h2>
					<p class="text-lg text-[#111827] dark:text-gray-300 max-w-3xl mx-auto">
						Une sélection de livres qui ont marqué mon parcours professionnel
					</p>
				</div>
				
				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
					{sortedBooks.slice(0, 6).map((book: any) => (
						<article class="bg-gray-50 dark:bg-gray-700 rounded-lg p-6 hover:shadow-md transition-shadow duration-300">
							{(book.data as any).cover && (
								<div class="mb-4">
									<img src={(book.data as any).cover} alt={book.data.title} class="w-full h-48 object-cover rounded-lg" />
								</div>
							)}
							
							<h3 class="text-xl font-bold text-[#111827] dark:text-white mb-3">
								<a href={`/books/${book.slug}`} class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
									{book.data.title}
								</a>
							</h3>
							
							<p class="text-[#111827] dark:text-gray-300 mb-4 line-clamp-3">
								{book.data.description}
							</p>
							
							<div class="flex items-center justify-between">
								<span class="text-sm text-gray-500 dark:text-gray-400">
									{book.data.author} • {book.data.publishYear}
								</span>
								<a href={`/books/${book.slug}`} 
								   class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium text-sm transition-colors">
									Voir le livre →
								</a>
							</div>
						</article>
					))}
			</div>
			
				<div class="text-center mt-8">
					<a href="/books" class="inline-flex items-center gap-2 px-6 py-3 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-colors font-medium">
						Voir tous les livres
						<i class="fas fa-arrow-right"></i>
					</a>
				</div>
			</div>
		</section>
		
		<!-- Call-to-action -->
		<section class="bg-gradient-to-r from-indigo-600 to-violet-600 rounded-xl text-white text-center p-12">
			<!-- Icône centrée -->
			<div class="flex items-center justify-center gap-4 mb-6">
				<div class="p-4 rounded-xl bg-white/20 backdrop-blur-sm">
					<i class="fas fa-envelope text-2xl"></i>
				</div>
			</div>
			
			<h2 class="text-3xl font-bold mb-4">Restez connecté</h2>
			<p class="text-xl mb-8 opacity-90 max-w-2xl mx-auto">
				Recevez mes derniers articles et recommandations directement dans votre boîte mail
			</p>
			<div class="flex flex-col sm:flex-row gap-4 justify-center max-w-md mx-auto">
				<input 
					type="email" 
					placeholder="Votre email" 
					class="px-6 py-3 rounded-lg text-gray-900 flex-1"
				/>
				<button class="px-8 py-3 bg-white text-indigo-600 rounded-lg font-semibold hover:bg-gray-100 transition-colors">
					S'abonner
				</button>
			</div>
		</section>
	</main>
</BaseLayout>

<style>
	/* Styles cohérents avec le design system */
	.line-clamp-2 {
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}
	
	.line-clamp-3 {
		display: -webkit-box;
		-webkit-line-clamp: 3;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}
	
	/* Centrage des titres pour le SEO et l'UX */
	h1, h2 {
		text-align: center;
	}
	
	/* Centrage des contenus associés aux H1/H2 */
	section > div:first-child {
		text-align: center;
	}
	
	/* Amélioration de la hiérarchie visuelle */
	.text-center h2 {
		margin-bottom: 1rem;
	}
	
	.text-center p {
		margin-left: auto;
		margin-right: auto;
	}
	
	/* Animations dynamiques avec courbes de Bézier */
	@keyframes fadeInUp {
		0% {
			opacity: 0;
			transform: translateY(40px) scale(0.95);
		}
		50% {
			opacity: 0.7;
			transform: translateY(20px) scale(0.98);
		}
		100% {
			opacity: 1;
			transform: translateY(0) scale(1);
		}
	}
	
	@keyframes slideInFromLeft {
		0% {
			opacity: 0;
			transform: translateX(-50px) rotateY(-15deg);
		}
		100% {
			opacity: 1;
			transform: translateX(0) rotateY(0deg);
		}
	}
	
	@keyframes slideInFromRight {
		0% {
			opacity: 0;
			transform: translateX(50px) rotateY(15deg);
		}
		100% {
			opacity: 1;
			transform: translateX(0) rotateY(0deg);
		}
	}
	
	@keyframes scaleInBounce {
		0% {
			opacity: 0;
			transform: scale(0.3) rotate(-10deg);
		}
		50% {
			opacity: 0.8;
			transform: scale(1.05) rotate(2deg);
		}
		70% {
			transform: scale(0.95) rotate(-1deg);
		}
		100% {
			opacity: 1;
			transform: scale(1) rotate(0deg);
		}
	}
	
	@keyframes typing {
		from { width: 0; }
		to { width: 100%; }
	}
	
	@keyframes float {
		0%, 100% { transform: translateY(0px); }
		50% { transform: translateY(-20px); }
	}
	
	@keyframes pulse-glow {
		0%, 100% { box-shadow: 0 0 5px rgba(99, 102, 241, 0.3); }
		50% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.6); }
	}
	
	@keyframes gradientX {
		0%, 100% { background-position: 0% 50%; }
		50% { background-position: 100% 50%; }
	}
	
	.animate-fade-in-up {
		animation: fadeInUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
		opacity: 0;
	}
	
	.animate-slide-in-left {
		animation: slideInFromLeft 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
		opacity: 0;
	}
	
	.animate-slide-in-right {
		animation: slideInFromRight 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
		opacity: 0;
	}
	
	.animate-scale-in-bounce {
		animation: scaleInBounce 0.7s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
		opacity: 0;
	}
	
	.typing-animation {
		overflow: hidden;
		border-right: 2px solid #4f46e5;
		white-space: nowrap;
		animation: typing 2s steps(20, end), blink-caret 0.75s step-end infinite;
	}
	
	.floating-particle {
		position: absolute;
		width: 8px;
		height: 8px;
		background: linear-gradient(45deg, #4f46e5, #7c3aed);
		border-radius: 50%;
		animation: float 6s ease-in-out infinite;
		opacity: 0.6;
	}
	
	/* Cartes d'articles modernes */
	.modern-article-card {
		position: relative;
		overflow: hidden;
		border-radius: 1rem;
		background: white;
		box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
		transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
		transform-style: preserve-3d;
	}
	
	.modern-article-card:hover {
		transform: translateY(-8px) rotateX(2deg) rotateY(1deg);
		box-shadow: 
			0 25px 50px -12px rgba(0, 0, 0, 0.25),
			0 0 0 1px rgba(59, 130, 246, 0.1);
	}
	
	.modern-article-card::before {
		content: '';
		position: absolute;
		top: 0;
		left: -100%;
		width: 100%;
		height: 100%;
		background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
		transition: left 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
		z-index: 10;
		pointer-events: none;
	}
	
	.modern-article-card:hover::before {
		left: 100%;
	}
	
	/* Animation d'apparition pour les cartes modernes */
	.modern-article-card {
		opacity: 0;
		transform: translateY(30px) scale(0.95);
		animation: modernCardAppear 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
	}
	
	@keyframes modernCardAppear {
		0% {
			opacity: 0;
			transform: translateY(30px) scale(0.95);
		}
		50% {
			opacity: 0.8;
			transform: translateY(-5px) scale(1.02);
		}
		100% {
			opacity: 1;
			transform: translateY(0) scale(1);
		}
	}
	
	/* Anciennes cartes pour compatibilité */
	.article-card {
		position: relative;
		overflow: hidden;
	}
	
	.article-card::before {
		content: '';
		position: absolute;
		top: 0;
		left: -100%;
		width: 100%;
		height: 100%;
		background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
		transition: left 0.5s;
	}
	
	.article-card:hover::before {
		left: 100%;
	}
	
	.filter-btn {
		position: relative;
		overflow: hidden;
	}
	
	.filter-btn::before {
		content: '';
		position: absolute;
		top: 0;
		left: -100%;
		width: 100%;
		height: 100%;
		background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
		transition: left 0.3s;
	}
	
	.filter-btn:hover::before {
		left: 100%;
	}
	
	.filter-btn.active {
		animation: pulse-glow 2s infinite;
	}
	
	.domain-section {
		transition: all 0.5s ease;
	}
	
	.domain-section.hidden {
		opacity: 0;
		transform: translateY(20px);
		pointer-events: none;
	}
	
	.counter {
		transition: all 0.3s ease;
	}
	
	/* Micro-interactions avancées pour les hashtags */
	.hashtag-keyword {
		position: relative;
		overflow: hidden;
		transform-style: preserve-3d;
		transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
	}
	
	.hashtag-keyword::after {
		content: '';
		position: absolute;
		top: 50%;
		left: 50%;
		width: 0;
		height: 0;
		background: radial-gradient(circle, rgba(59, 130, 246, 0.3) 0%, transparent 70%);
		border-radius: 50%;
		transform: translate(-50%, -50%);
		transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
		pointer-events: none;
		z-index: 1;
	}
	
	.hashtag-keyword:hover::after {
		width: 200px;
		height: 200px;
		animation: ripple 0.6s ease-out;
	}
	
	@keyframes ripple {
		0% {
			transform: translate(-50%, -50%) scale(0);
			opacity: 1;
		}
		100% {
			transform: translate(-50%, -50%) scale(1);
			opacity: 0;
		}
	}
	
	/* Effet de particules flottantes au survol */
	.hashtag-keyword:hover {
		transform: translateY(-3px) scale(1.05) rotateX(5deg);
		box-shadow: 
			0 10px 25px rgba(59, 130, 246, 0.3),
			0 0 0 1px rgba(59, 130, 246, 0.1);
	}
	
	/* Animation de pulsation pour les mots-clés actifs */
	.hashtag-keyword.active {
		animation: pulse-glow 2s infinite;
		background: linear-gradient(45deg, #3b82f6, #1d4ed8) !important;
		color: white !important;
	}
	
	/* Effet de brillance au survol */
	.hashtag-keyword::before {
		content: '';
		position: absolute;
		top: 0;
		left: -100%;
		width: 100%;
		height: 100%;
		background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
		transition: left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
		z-index: 2;
	}
	
	.hashtag-keyword:hover::before {
		left: 100%;
	}
	
	/* Responsive */
	@media (max-width: 768px) {
		.content-container {
			padding: 0 1rem;
		}
		
		section {
			padding: 1.5rem;
		}
		
		/* Ajustement des titres sur mobile */
		h1 {
			font-size: 2rem;
		}
		
		h2 {
			font-size: 1.75rem;
		}
		
		.floating-particle {
			display: none;
		}
	}
</style>

<script is:inline>
  // Ajout de Font Awesome
  if (!document.querySelector('#font-awesome')) {
    const link = document.createElement('link');
    link.id = 'font-awesome';
    link.rel = 'stylesheet';
    link.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';
    document.head.appendChild(link);
  }
  
  // Animation pour les éléments au scroll
  document.addEventListener('DOMContentLoaded', function() {
    // Animation des compteurs
    function animateCounters() {
      const counters = document.querySelectorAll('.counter');
      counters.forEach(counter => {
        const target = parseInt(counter.getAttribute('data-target'));
        const duration = 2000; // 2 secondes
        const increment = target / (duration / 16); // 60fps
        let current = 0;
        
        const timer = setInterval(() => {
          current += increment;
          if (current >= target) {
            current = target;
            clearInterval(timer);
          }
          counter.textContent = Math.floor(current);
        }, 16);
      });
    }
    
    // Filtrage dynamique des domaines
    function initDomainFiltering() {
      const filterButtons = document.querySelectorAll('.filter-btn');
      const domainSections = document.querySelectorAll('.domain-section');
      
      filterButtons.forEach(button => {
        button.addEventListener('click', function() {
          const filter = this.getAttribute('data-filter');
          
          // Mettre à jour l'état actif des boutons
          filterButtons.forEach(btn => btn.classList.remove('active'));
          this.classList.add('active');
          
          // Filtrer les sections
          domainSections.forEach(section => {
            if (filter === 'all' || section.getAttribute('data-domain') === filter) {
              section.classList.remove('hidden');
              section.style.animationDelay = '0s';
            } else {
              section.classList.add('hidden');
            }
          });
          
          // Animation de réapparition
          setTimeout(() => {
            domainSections.forEach(section => {
              if (!section.classList.contains('hidden')) {
                section.style.animation = 'fadeInUp 0.6s ease-out forwards';
              }
            });
          }, 100);
        });
      });
    }
    
    // Animation des cartes d'articles avec micro-interactions
    function initArticleCards() {
      const articleCards = document.querySelectorAll('.article-card');
      
      articleCards.forEach((card, index) => {
        // Animation d'apparition en cascade avec courbes de Bézier
        const animationType = index % 3;
        const animationClasses = ['animate-fade-in-up', 'animate-slide-in-left', 'animate-slide-in-right'];
        card.style.animationDelay = `${index * 0.15}s`;
        card.classList.add(animationClasses[animationType]);
        
        // Effet de survol avancé avec 3D
        card.addEventListener('mouseenter', function() {
          this.style.transform = 'translateY(-12px) scale(1.03) rotateX(5deg) rotateY(2deg)';
          this.style.boxShadow = '0 25px 50px rgba(0,0,0,0.15), 0 0 0 1px rgba(59, 130, 246, 0.1)';
          this.style.transition = 'all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
        });
        
        card.addEventListener('mouseleave', function() {
          this.style.transform = 'translateY(0) scale(1) rotateX(0deg) rotateY(0deg)';
          this.style.boxShadow = '';
          this.style.transition = 'all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
        });
        
        // Effet de clic avec rebond
        card.addEventListener('click', function() {
          this.style.transform = 'translateY(-8px) scale(0.98)';
          setTimeout(() => {
            this.style.transform = 'translateY(-12px) scale(1.03) rotateX(5deg) rotateY(2deg)';
          }, 100);
        });
      });
    }
    
    // Gestion des favoris
    function initFavorites() {
      const favoriteButtons = document.querySelectorAll('[title="Ajouter aux favoris"]');
      
      favoriteButtons.forEach(button => {
        button.addEventListener('click', function(e) {
          e.preventDefault();
          const icon = this.querySelector('i');
          
          if (icon.classList.contains('fa-heart')) {
            icon.classList.remove('fa-heart');
            icon.classList.add('fas', 'fa-heart');
            icon.style.color = '#ef4444';
            this.style.transform = 'scale(1.2)';
            
            // Animation de confirmation
            setTimeout(() => {
              this.style.transform = 'scale(1)';
            }, 200);
          } else {
            icon.classList.remove('fas');
            icon.classList.add('fa-heart');
            icon.style.color = '#9ca3af';
          }
        });
      });
    }
    
    // Parallax pour les particules
    function initParallax() {
      const particles = document.querySelectorAll('.floating-particle');
      
      window.addEventListener('scroll', () => {
        const scrolled = window.pageYOffset;
        const rate = scrolled * -0.5;
        
        particles.forEach((particle, index) => {
          const speed = (index + 1) * 0.1;
          particle.style.transform = `translateY(${rate * speed}px)`;
        });
      });
    }
    
    // Animation et gestion des hashtags
    function initHashtagAnimations() {
      const hashtags = document.querySelectorAll('.hashtag-keyword');
      
      hashtags.forEach(hashtag => {
        // Animation d'apparition en cascade
        hashtag.style.opacity = '0';
        hashtag.style.transform = 'translateY(10px)';
        
        setTimeout(() => {
          hashtag.style.transition = 'all 0.3s ease';
          hashtag.style.opacity = '1';
          hashtag.style.transform = 'translateY(0)';
        }, parseInt(hashtag.style.animationDelay?.replace('s', '') || '0') * 1000 + 500);
        
        hashtag.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          
          // Effet de rebond et changement de couleur
          this.style.transform = 'scale(1.15)';
          this.style.background = 'linear-gradient(45deg, #3b82f6, #1d4ed8)';
          this.style.color = 'white';
          this.style.boxShadow = '0 4px 12px rgba(59, 130, 246, 0.4)';
          
          // Animation de confirmation
          setTimeout(() => {
            this.style.transform = 'scale(1)';
            this.style.background = '';
            this.style.color = '';
            this.style.boxShadow = '';
          }, 300);
          
          // Recherche d'articles avec ce hashtag
          const keyword = this.getAttribute('data-keyword');
          filterArticlesByKeyword(keyword);
          
          // Feedback visuel
          showKeywordFeedback(keyword);
        });
        
        // Effet de survol
        hashtag.addEventListener('mouseenter', function() {
          this.style.transform = 'scale(1.05)';
          this.style.boxShadow = '0 2px 8px rgba(59, 130, 246, 0.3)';
        });
        
        hashtag.addEventListener('mouseleave', function() {
          this.style.transform = 'scale(1)';
          this.style.boxShadow = '';
        });
      });
    }
    
    // Fonction pour filtrer les articles par mot-clé
    function filterArticlesByKeyword(keyword) {
      const domainSections = document.querySelectorAll('.domain-section');
      let foundArticles = 0;
      
      domainSections.forEach(section => {
        const articles = section.querySelectorAll('.article-card');
        let hasMatchingArticle = false;
        
        articles.forEach(article => {
          const articleKeywords = article.querySelectorAll('.hashtag-keyword');
          let articleMatches = false;
          
          articleKeywords.forEach(tag => {
            if (tag.getAttribute('data-keyword') === keyword) {
              articleMatches = true;
              foundArticles++;
            }
          });
          
          if (articleMatches) {
            hasMatchingArticle = true;
            article.style.border = '2px solid #3b82f6';
            article.style.boxShadow = '0 0 20px rgba(59, 130, 246, 0.3)';
          } else {
            article.style.opacity = '0.5';
            article.style.filter = 'grayscale(50%)';
          }
        });
        
        if (hasMatchingArticle) {
          section.classList.remove('hidden');
        } else {
          section.classList.add('hidden');
        }
      });
      
      // Mettre à jour le bouton de filtre actif
      const filterButtons = document.querySelectorAll('.filter-btn');
      filterButtons.forEach(btn => btn.classList.remove('active'));
      
      // Créer un bouton temporaire pour le mot-clé
      const keywordButton = document.querySelector(`[data-filter="${keyword}"]`);
      if (keywordButton) {
        keywordButton.classList.add('active');
      }
      
      return foundArticles;
    }
    
    // Fonction pour afficher un feedback visuel
    function showKeywordFeedback(keyword) {
      // Créer une notification temporaire
      const notification = document.createElement('div');
      notification.className = 'fixed top-4 right-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
      notification.innerHTML = `
        <div class="flex items-center gap-2">
          <i class="fas fa-search"></i>
          <span>Recherche: ${keyword}</span>
        </div>
      `;
      
      document.body.appendChild(notification);
      
      // Animation d'entrée
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 100);
      
      // Suppression après 3 secondes
      setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 3000);
    }
    
    // Fonction pour réinitialiser les filtres
    function resetFilters() {
      const domainSections = document.querySelectorAll('.domain-section');
      const articles = document.querySelectorAll('.article-card');
      
      domainSections.forEach(section => {
        section.classList.remove('hidden');
      });
      
      articles.forEach(article => {
        article.style.border = '';
        article.style.boxShadow = '';
        article.style.opacity = '';
        article.style.filter = '';
      });
      
      // Réactiver le bouton "Tous les domaines"
      const filterButtons = document.querySelectorAll('.filter-btn');
      filterButtons.forEach(btn => btn.classList.remove('active'));
      const allButton = document.querySelector('[data-filter="all"]');
      if (allButton) {
        allButton.classList.add('active');
      }
    }
    
    // Intersection Observer pour les animations
    const observer = new IntersectionObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate-fade-in-up');
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1 });
    
    // Observer toutes les sections
    document.querySelectorAll('section').forEach(function(section) {
      observer.observe(section);
    });
    
    // Gestion des paramètres URL pour le filtrage par mot-clé
    function initUrlFiltering() {
      const urlParams = new URLSearchParams(window.location.search);
      const keywordParam = urlParams.get('keyword');
      
      if (keywordParam) {
        // Filtrer automatiquement par le mot-clé de l'URL
        filterArticlesByKeyword(keywordParam);
        
        // Mettre en évidence le mot-clé dans l'URL
        const hashtags = document.querySelectorAll('.hashtag-keyword');
        hashtags.forEach(hashtag => {
          if (hashtag.getAttribute('data-keyword') === keywordParam) {
            hashtag.style.background = 'linear-gradient(45deg, #3b82f6, #1d4ed8)';
            hashtag.style.color = 'white';
            hashtag.style.boxShadow = '0 4px 12px rgba(59, 130, 246, 0.4)';
          }
        });
        
        // Afficher une notification
        showKeywordFeedback(keywordParam);
      }
    }
    
    // Initialisation des fonctionnalités
    setTimeout(animateCounters, 500);
    initDomainFiltering();
    initArticleCards();
    initFavorites();
    initParallax();
    initHashtagAnimations();
    initUrlFiltering();
    
    // Gestion des erreurs d'images
    document.querySelectorAll('img').forEach(function(img) {
      img.addEventListener('error', function() {
        const fallbackSrc = '/placeholder-article.webp';
        if (this.src !== fallbackSrc) {
          this.src = fallbackSrc;
        } else {
          const div = document.createElement('div');
          div.className = 'w-full h-full bg-gradient-to-r from-indigo-500 to-blue-500 flex items-center justify-center';
          div.innerHTML = '<i class="fas fa-newspaper text-white text-4xl"></i>';
          this.parentNode.replaceChild(div, this);
        }
      });
    });
    
    // Gestion des déconnexions du serveur
    let reconnectAttempts = 0;
    const maxReconnectAttempts = 5;
    
    function reconnectToServer() {
      if (reconnectAttempts < maxReconnectAttempts) {
        console.log(`Tentative de reconnexion au serveur (${reconnectAttempts + 1}/${maxReconnectAttempts})...`);
        setTimeout(function() {
          window.location.reload();
        }, 3000);
        reconnectAttempts++;
      } else {
        console.error("Impossible de se reconnecter au serveur après plusieurs tentatives.");
      }
    }
    
    window.addEventListener('offline', function() {
      console.warn('Connexion au réseau perdue.');
    });
    
    window.addEventListener('online', function() {
      console.log('Connexion au réseau rétablie, tentative de reconnexion...');
      reconnectToServer();
    });
  });
</script> 